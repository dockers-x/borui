<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Borui</title>
    <style>
        :root {
            --primary: #9770c9;
            --primary-light: #b89bd9;
            --primary-dark: #7a5aa8;
            --secondary: #d5a3e9;
            --bg-primary: #f5f5ff;
            --bg-card: #ffffff;
            --text-primary: #2d3436;
            --text-secondary: #636e72;
            --text-tertiary: #b2bec3;
            --danger: #d63031;
            --shadow-lg: 0 8px 32px rgba(151, 112, 201, 0.16);
            --radius-lg: 16px;
            --radius-xl: 20px;
            --space-sm: 1rem;
            --space-md: 1.5rem;
            --space-lg: 2rem;
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'SF Pro Display', 'Roboto', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #9770c9 0%, #d5a3e9 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: relative;
            padding: var(--space-lg);
            -webkit-font-smoothing: antialiased;
        }

        .background-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image:
                radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 255, 255, 0.2) 0%, transparent 50%);
        }

        .lang-selector-wrapper {
            position: absolute;
            top: var(--space-lg);
            right: var(--space-lg);
            z-index: 10;
        }

        .lang-select {
            padding: var(--space-sm);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-lg);
            background: rgba(255, 255, 255, 0.9);
            color: var(--primary);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all var(--transition-base);
            backdrop-filter: blur(10px);
        }

        .lang-select:hover {
            background: white;
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .login-container {
            background: var(--bg-card);
            padding: var(--space-lg) var(--space-lg) var(--space-lg);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 420px;
            position: relative;
            z-index: 1;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: var(--space-lg);
        }

        .logo {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--space-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 4px 16px rgba(151, 112, 201, 0.3));
        }

        .login-header h1 {
            color: var(--text-primary);
            font-size: 1.875rem;
            font-weight: 700;
            margin-bottom: var(--space-xs);
        }

        .login-header p {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            font-weight: 500;
        }

        .error-message {
            background: rgba(214, 48, 49, 0.1);
            color: var(--danger);
            padding: var(--space-sm);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-md);
            display: none;
            font-size: 0.875rem;
            font-weight: 500;
            border: 2px solid rgba(214, 48, 49, 0.2);
        }

        .error-message.show {
            display: block;
            animation: shake 0.4s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .form-group {
            margin-bottom: var(--space-md);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.9375rem;
        }

        .form-group input {
            width: 100%;
            padding: var(--space-sm);
            border: 2px solid #d5dae0;
            border-radius: var(--radius-lg);
            font-size: 0.9375rem;
            color: var(--text-primary);
            background: #fafaff;
            transition: all var(--transition-base);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 4px rgba(151, 112, 201, 0.1);
        }

        .btn-login {
            width: 100%;
            padding: var(--space-sm);
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            font-size: 0.9375rem;
            font-weight: 700;
            cursor: pointer;
            transition: all var(--transition-base);
            box-shadow: 0 4px 16px rgba(151, 112, 201, 0.3);
            margin-top: var(--space-sm);
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(151, 112, 201, 0.4);
        }

        .btn-login:active {
            transform: translateY(0);
        }

        .btn-login:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .footer-text {
            text-align: center;
            margin-top: var(--space-lg);
            color: var(--text-tertiary);
            font-size: 0.8125rem;
        }

        @media (max-width: 768px) {
            .lang-selector-wrapper {
                top: var(--space-sm);
                right: var(--space-sm);
            }

            .login-container {
                padding: var(--space-md);
            }
        }
    </style>
</head>
<body>
    <div class="background-pattern"></div>

    <div class="lang-selector-wrapper">
        <select id="language-selector" class="lang-select">
            <option value="en">English</option>
            <option value="zh-CN">简体中文</option>
            <option value="zh-TW">繁體中文</option>
        </select>
    </div>

    <div class="login-container">
        <div class="login-header">
            <div class="logo">
                <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <path d="M511.4 512.4m-447.2 0a447.2 447.2 0 1 0 894.4 0 447.2 447.2 0 1 0-894.4 0Z" fill="#FEBE49"></path>
                    <path d="M511.5 959.8c-23.4 0-96.3-1.8-176-36-29.7-12.7-52.5-26.5-62.7-33-21.4-13.6-51.6-35.1-82.5-67.1a453.57 453.57 0 0 1-56.5-71.7c7.1-35.8 14-64.7 19-84.4 26.6-104.9 35.1-153.3 54.7-212.4 6.7-20.1 10.1-30.4 15.7-43.2 27.6-62.6 66-100.1 75.8-109.4 30.7-29 62.4-47.3 88-58.9 30.6-11.1 61.5-20.7 94.2-23.7 30.3-2.8 60.1-1.5 89.5 4.3 6.1 1.2 17.4 3.6 31.3 7.9 8.6 2.6 35.4 11.3 64.2 27.7 49.8 28.5 82 67.1 97.4 88 23.5 32 37.8 63.7 46.6 89.9 4.6 28.4 15.1 55.2 22.2 82.9 21.1 82.5 22.1 132 50.1 214.8 2.5 7.5 4.7 13.6 6.1 17.5-22.4 34.8-75.3 106.8-171.7 156.7-33.9 17.5-107.4 50.1-205.4 50.1z" fill="#5D3D1E"></path>
                    <path d="M569.5 533.1c1.3-4.2 4.2-2.6 6.7-1.6 39 16.4 73.3 54.1 72.2 101-0.6 26.2-10.9 48.3-28.6 67.1-52.8 56-153.5 57.9-208.7 4-55.3-54-37-132.4 29.9-167.5 2.7-1.4 6.3-4.5 8.3 1.1 2.8 1.5 3.6 3.7 3.4 6.9-2.1 25 14.4 41.8 36.5 48.8 21.2 6.7 21.1 6.9 21.1 29.6v28.6c0.1-13.5 0.2-27 0-40.4-0.1-8.5 2.6-13.6 11.6-15.2 8.8-1.6 17.4-4.7 25-9.7 15.1-10 22.8-23.7 20.6-42.1-0.4-3.8-1.5-7.6 2-10.6z" fill="#9D764F"></path>
                    <path d="M214.7 437.5c-38.9-34.7-52.4-78.2-39.8-128.1 12.8-51.1 47-83.1 98.5-93.6 42.8-8.8 81.4 2 113.4 32.9-22.6 13.3-45.9 25.3-66.3 42.1-43.3 35.7-75.4 79.4-95.9 131.7-2.3 5.5-3 12.4-9.9 15zM636 246.7c38.2-39.5 108.3-44.9 157.7-12.1 69.7 46.4 76 149.5 12.2 202.8-4.3-1.9-5.4-6-6.8-9.9-27.7-78.1-79.9-134.6-152.7-172.7-4-2-8.4-3.5-10.4-8.1z" fill="#4E3218"></path>
                    <path d="M569.5 533.1c8.6 21.4 2.4 41.8-16.9 55.5-6 4.2-12.5 7.4-19.5 9.5-17.6 5.4-17.6 5.5-17.6 24.5 0 12.1 0.2 24.2-0.1 36.3-0.1 4.7 2.2 12.3-5.4 12.2-6.6-0.1-4.8-7.2-4.8-11.8-0.2-15.9-0.4-31.8 0.1-47.8 0.2-7.1-1.7-10.5-9.2-11.6-13.3-2-25.1-7.6-34.7-17.3-12.7-12.9-17.6-27.8-12-45.5 18.8-48.4 97.7-49.6 120.1-4zM385.7 468.7c14.7 0.4 33.6 5.7 52.1 12.8 6 2.3 10.7 6.4 7.7 13.4s-8.7 7.5-15.7 5c-25.8-9.4-52-14.5-79.1-6-5.6 1.7-11 4-16.4 6.3-6.6 2.8-11.9 1.1-14.7-5.2-2.9-6.5 1.3-10.8 6.8-13.1 17.3-7.2 34.9-13.3 59.3-13.2zM640 493.5c-15.4 0.5-30 3.1-43.6 9.6-7.3 3.5-14 3.9-17.2-4.4-3-7.6 3-10.8 9-13.7 36.3-17.1 72.4-14.4 108.6 0.3 5.9 2.4 11.1 6 8.5 13.1-2.8 7.7-8.9 8.3-16.2 5.5-15.9-6.3-32.5-9.4-49.1-10.4z" fill="#301D0B"></path>
                    <path d="M513.2 707.5c-13.6 0.2-26.9-2.1-39.7-6.6-5.3-1.8-10.3-4.2-14.2-8.3-3.1-3.2-9.1-6.5-4.1-11.8 5.1-5.4 7.5 1.5 10.6 3.9 3.6 2.8 7.4 5 11.7 6.5 23 8.1 46.1 8.1 69.3 0.9 6.3-1.9 12.2-4.8 16.7-10 2.1-2.4 4.5-4.8 7.8-1.9 3.4 3 2.1 6.1-0.4 9.1-4.4 5.1-9.8 8.7-16.1 11-13.4 5-27.3 7.5-41.6 7.2z" fill="#311E0C"></path>
                </svg>
            </div>
            <h1 data-i18n="login.title">Borui</h1>
            <p data-i18n="login.subtitle">Tunnel Management Platform</p>
        </div>

        <div id="error" class="error-message"></div>

        <form id="login-form">
            <div class="form-group">
                <label for="username" data-i18n="login.username">Username</label>
                <input type="text" id="username" name="username" required autofocus>
            </div>

            <div class="form-group">
                <label for="password" data-i18n="login.password">Password</label>
                <input type="password" id="password" name="password" required>
            </div>

            <button type="submit" class="btn-login" data-i18n="login.loginButton">Login</button>
        </form>

        <div class="footer-text">
            Powered by Borui &copy; 2025
        </div>
    </div>

    <script src="/js/i18n.js"></script>
    <script>
        // Load i18n
        (async function() {
            await i18n.loadLocale(i18n.locale);

            // Setup language selector
            const langSelector = document.getElementById('language-selector');
            langSelector.value = i18n.locale;
            langSelector.addEventListener('change', async (e) => {
                await i18n.loadLocale(e.target.value);
            });
        })();

        const form = document.getElementById('login-form');
        const errorDiv = document.getElementById('error');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const submitBtn = form.querySelector('button');

            submitBtn.disabled = true;
            submitBtn.setAttribute('data-i18n', 'login.loggingIn');
            submitBtn.textContent = i18n.translations.login?.loggingIn || 'Logging in...';
            errorDiv.classList.remove('show');

            try {
                const response = await fetch('/api/v1/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password }),
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Login failed');
                }

                // Save token
                localStorage.setItem('token', data.token);
                localStorage.setItem('user', JSON.stringify(data.user));

                // Redirect to main page
                window.location.href = '/';
            } catch (error) {
                errorDiv.textContent = error.message;
                errorDiv.classList.add('show');
                submitBtn.disabled = false;
                submitBtn.setAttribute('data-i18n', 'login.loginButton');
                submitBtn.textContent = i18n.translations.login?.loginButton || 'Login';
            }
        });
    </script>
</body>
</html>
